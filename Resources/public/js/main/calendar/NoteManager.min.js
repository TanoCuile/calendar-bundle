if(!window.MainElements){window.MainElements={}}if(!window.MainElements.initAppCallStack){window.MainElements.initAppCallStack=[]}MainElements.initAppCallStack.push(function(a){a.factory("NoteManager",["DateManager",function(c){var b=function(d){this.display={};angular.extend(this,d);this.setFromTime=function(e){this.fromTime=e};this.setDuration=function(e){this.duration=e};this.getFromTime=function(){return this.fromTime};this.getDuration=function(){return this.duration};this.calculateDisplayHeight=function(){var e=this.getDuration();if(this.offsetBottom){e-=c.timeSectionDuration}if(this.offsetTop){e-=c.timeSectionDuration}this.display.height=c.timeToPixel(e)};this.calculateDisplayTop=function(){var e=this.fromTime-this.blank.getPlanStart();if(this.offsetTop){e+=c.timeSectionDuration}this.display.top=c.timeToPixel(e)}};return{defaultNoteData:{duration:0,fromTime:0,offsetTop:false,offsetBottom:false},getDefaultNoteInfo:function(d){if(!d){d={}}return angular.extend(d,this.defaultNoteData,{id:Math.random().toString(36).substring(10)})},prepareNote:function(d){return new b(d)}}}]);a.directive("calendarNote",["DateManager",function(b){return{templateUrl:"/bundles/calendar/html/note.html.tpl",replace:true,restrict:"E",scope:{note:"=",noteChangeCallback:"&"},link:function(d,e,c){d.$watch("note.fromTime",function(f){d.note.calculateDisplayTop()});d.$watch("note.offsetTop",function(){d.note.calculateDisplayTop();d.note.calculateDisplayHeight()});d.$watch("note.duration",function(f){d.note.calculateDisplayHeight()});d.$watch("note.offsetBottom",function(){d.note.calculateDisplayHeight()})}}}])});